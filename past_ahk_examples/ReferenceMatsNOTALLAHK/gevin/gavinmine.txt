	

    Func GetStaminaPosition
            $answer = MsgBox(0,"Mining Macro","Move your mouse cursor to the rightmost edge of your stamina bar.")
            Sleep(1000)
            Global $staminaPosition = MouseGetPos()
            global $staminaColor = PixelGetColor($staminaPosition[0],$staminaPosition[1])
    EndFunc
     
    Func WaitForStamina()
            $done = False
            $wait = 0
            While $done = False
                    $coord = PixelSearch($staminaPosition[0],$staminaPosition[1],$staminaPosition[0] + 1,$staminaPosition[1] + 1,$staminaColor,3)
                    If Not @error Then
                            $done = True
                            $wait = 0
                    Else
                            Sleep(500)
                            $wait = $wait + 1
                            If $wait > 40 Then
                                    Beep()
                                    MsgBox(0,"Macro","Your stamina appears to have stopped regenerating.")
                                    $wait = 0
                            EndIf
                EndIf
       WEnd
    EndFunc
     
     
     
    Func OpenLogFile($userName,$wurmPath ) ; Player user name, location of the wurm installation folder
       $fileName = $wurmPath & "\players\" & $userName & "\logs\_Event." & @YEAR & "-" & @MON & ".txt"
       Global $logFile = FileOpen($fileName,0)
       If $logFile = -1 Then
              MsgBox(0, "Error","Unable to open file. Terminating script.")
              Exit
       EndIf
    EndFunc
     
    Example Input
    $userName = "Gavin"
    $wurmPath = "C:\Users\Gavin\wurm"
     
     
     
    Func Repair($toolPosition)
            $targetPosition = MouseGetPos()
            MouseMove($toolPosition[0],$toolPosition[1],0)
            Sleep(80)
            Send($repair)
            MouseMove($targetPosition[0],$targetPosition[1],0)
            Sleep(80)
    EndFunc
     
     
     
     Func Eat($foodPosition)
            $targetPosition = MouseGetPos()
     
            MouseMove($foodPosition[0], $foodPosition[1])
            MouseClick("right")
            $wait = Random(2000,4000,1)
            Sleep ($wait)
     
            MouseMove($foodPosition[0] + 25, $foodPosition[1] + 70)
            $wait = Random(500,2000,1)
            Sleep ($wait)
            MouseClick("left")
     
            $wait = Random(2000,5000,1)
            Sleep ($wait)
            MouseMove($targetPosition[0],$targetPosition[1],0)
     EndFunc
     
     
    Func Drink($waterPosition)
       $targetPosition = MouseGetPos()
     
       MouseMove($waterPosition[0], $waterPosition[1])
       MouseClick("right")
       $wait = Random(2000,4000,1)
       Sleep ($wait)
     
       MouseMove($waterPosition[0] + 25, $waterPosition[1] + 78)
       $wait = Random(500,2000,1)
       Sleep ($wait)
       MouseClick("left")
     
       $wait = Random(2000,5000,1)
       Sleep ($wait)
       MouseMove($targetPosition[0],$targetPosition[1],0)
    EndFunc

